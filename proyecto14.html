<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semana 14 - Microservicios en Django</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255, 255, 255, 0.1) 10px,
                rgba(255, 255, 255, 0.1) 20px
            );
            animation: movePattern 20s linear infinite;
        }

        @keyframes movePattern {
            0% { transform: translateX(-50px) translateY(-50px); }
            100% { transform: translateX(50px) translateY(50px); }
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .section h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h2::before {
            content: 'üöÄ';
            font-size: 1.2em;
        }

        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .topic-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .topic-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
        }

        .topic-card h3 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .topic-card p {
            color: #6c757d;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .exercise-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .exercise-title {
            color: #495057;
            font-size: 1.3em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exercise-title::before {
            content: '‚öôÔ∏è';
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .demo-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px dashed #667eea;
        }

        .demo-title {
            color: #667eea;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .microservice-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .service-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .service-card:hover {
            border-color: #667eea;
            transform: scale(1.05);
        }

        .service-card h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .service-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .communication-demo {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .service-flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .flow-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #667eea;
            min-width: 120px;
            text-align: center;
        }

        .flow-arrow {
            font-size: 1.5em;
            color: #667eea;
        }

        .reflection-text {
            line-height: 1.8;
            color: #495057;
            background: white;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }

        .highlight {
            background: linear-gradient(120deg, #a8e6cf 0%, #dcedc8 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .interactive-demo {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #e9ecef;
        }

        .log-container {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 2px 0;
        }

        .log-success {
            color: #48bb78;
        }

        .log-error {
            color: #f56565;
        }

        .log-info {
            color: #4299e1;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .section {
                padding: 20px;
            }
            
            .topics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Semana 14</h1>
            <p>Microservicios en Django - Arquitectura escalable y distribuida</p>
        </div>

        <div class="content">
            <!-- Temas Aprendidos -->
            <div class="section">
                <h2>Temas Aprendidos</h2>
                <div class="topics-grid">
                    <div class="topic-card" onclick="showTopicDetails('microservicios')">
                        <h3>üèóÔ∏è Arquitectura de Microservicios</h3>
                        <p>Principios fundamentales, ventajas y desaf√≠os de la arquitectura de microservicios comparada con monolitos.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('django-micro')">
                        <h3>üöÄ Django para Microservicios</h3>
                        <p>Configuraci√≥n y adaptaci√≥n de Django para crear microservicios eficientes y escalables.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('comunicacion')">
                        <h3>üîÑ Comunicaci√≥n entre Servicios</h3>
                        <p>REST APIs, message queues, event-driven architecture y patrones de comunicaci√≥n.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('bases-datos')">
                        <h3>üóÑÔ∏è Gesti√≥n de Bases de Datos</h3>
                        <p>Database per service, transacciones distribuidas y consistencia eventual.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('docker-k8s')">
                        <h3>üê≥ Docker & Kubernetes</h3>
                        <p>Containerizaci√≥n de microservicios y orquestaci√≥n con Kubernetes para escalabilidad.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('seguridad')">
                        <h3>üîí Seguridad en Microservicios</h3>
                        <p>Autenticaci√≥n, autorizaci√≥n, JWT tokens y gateway security patterns.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('monitoreo')">
                        <h3>üìä Monitoreo y Escalado</h3>
                        <p>Logging distribuido, m√©tricas, health checks y auto-scaling strategies.</p>
                    </div>
                    <div class="topic-card" onclick="showTopicDetails('consumo')">
                        <h3>üîå Consumo de Microservicios</h3>
                        <p>Integraci√≥n de servicios, service discovery y circuit breaker patterns.</p>
                    </div>
                </div>

                <div class="exercise-container">
                    <div class="exercise-title">Conceptos Clave Implementados</div>
                    <div class="code-block">
# Estructura b√°sica de un microservicio en Django
# settings.py
MICROSERVICE_CONFIG = {
    'SERVICE_NAME': 'user-service',
    'VERSION': '1.0.0',
    'PORT': 8001,
    'DISCOVERY_URL': 'http://service-registry:8000',
    'DATABASE_PER_SERVICE': True,
    'ASYNC_COMMUNICATION': True,
    'CIRCUIT_BREAKER_ENABLED': True,
    'HEALTH_CHECK_ENDPOINT': '/health/',
    'METRICS_ENDPOINT': '/metrics/',
}

# Service Registration
from django.apps import AppConfig
import requests

class UserServiceConfig(AppConfig):
    name = 'user_service'
    
    def ready(self):
        self.register_service()
    
    def register_service(self):
        service_info = {
            'name': settings.MICROSERVICE_CONFIG['SERVICE_NAME'],
            'url': f"http://localhost:{settings.MICROSERVICE_CONFIG['PORT']}",
            'health_check': f"http://localhost:{settings.MICROSERVICE_CONFIG['PORT']}/health/",
            'version': settings.MICROSERVICE_CONFIG['VERSION']
        }
        
        try:
            requests.post(
                f"{settings.MICROSERVICE_CONFIG['DISCOVERY_URL']}/register",
                json=service_info
            )
        except Exception as e:
            print(f"Failed to register service: {e}")
                    </div>
                </div>
            </div>

            <!-- Ejercicios y Resultados -->
            <div class="section">
                <h2>Ejercicios y Resultados</h2>
                
                <div class="exercise-container">
                    <div class="exercise-title">1. Arquitectura de Microservicios</div>
                    <p>Implementaci√≥n de un sistema distribuido con m√∫ltiples servicios Django.</p>
                    
                    <div class="demo-section">
                        <div class="demo-title">üèóÔ∏è Simulaci√≥n de Arquitectura de Microservicios</div>
                        <div class="microservice-demo">
                            <div class="service-card" onclick="toggleService('user-service')">
                                <h4>üë• User Service</h4>
                                <p>Gesti√≥n de usuarios</p>
                                <div class="service-status status-active" id="user-service-status">‚óè ACTIVE</div>
                            </div>
                            <div class="service-card" onclick="toggleService('product-service')">
                                <h4>üì¶ Product Service</h4>
                                <p>Cat√°logo de productos</p>
                                <div class="service-status status-active" id="product-service-status">‚óè ACTIVE</div>
                            </div>
                            <div class="service-card" onclick="toggleService('order-service')">
                                <h4>üõí Order Service</h4>
                                <p>Procesamiento de pedidos</p>
                                <div class="service-status status-active" id="order-service-status">‚óè ACTIVE</div>
                            </div>
                            <div class="service-card" onclick="toggleService('payment-service')">
                                <h4>üí≥ Payment Service</h4>
                                <p>Procesamiento de pagos</p>
                                <div class="service-status status-active" id="payment-service-status">‚óè ACTIVE</div>
                            </div>
                        </div>
                    </div>

                    <div class="code-block">
# User Service - views.py
from django.http import JsonResponse
from django.views.decorators.csrf import csrf_exempt
from django.utils.decorators import method_decorator
from django.views import View
import json
import uuid

@method_decorator(csrf_exempt, name='dispatch')
class UserAPIView(View):
    def get(self, request, user_id=None):
        if user_id:
            # Simular b√∫squeda de usuario
            user_data = {
                'id': user_id,
                'username': f'user_{user_id}',
                'email': f'user_{user_id}@example.com',
                'service': 'user-service',
                'version': '1.0.0'
            }
            return JsonResponse(user_data)
        else:
            return JsonResponse({'users': ['user_1', 'user_2', 'user_3']})
    
    def post(self, request):
        data = json.loads(request.body)
        user_id = str(uuid.uuid4())
        
        # Simular creaci√≥n de usuario
        response_data = {
            'id': user_id,
            'username': data.get('username'),
            'email': data.get('email'),
            'created': True,
            'service': 'user-service'
        }
        
        return JsonResponse(response_data, status=201)

# Health Check
def health_check(request):
    return JsonResponse({
        'status': 'healthy',
        'service': 'user-service',
        'version': '1.0.0',
        'timestamp': '2024-01-15T10:30:00Z'
    })
                    </div>
                </div>

                <div class="exercise-container">
                    <div class="exercise-title">2. Comunicaci√≥n entre Microservicios</div>
                    <p>Implementaci√≥n de patrones de comunicaci√≥n s√≠ncrona y as√≠ncrona.</p>
                    
                    <div class="communication-demo">
                        <div class="demo-title">üîÑ Flujo de Comunicaci√≥n</div>
                        <div class="service-flow">
                            <div class="flow-item">Frontend</div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-item">API Gateway</div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-item">User Service</div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-item">Order Service</div>
                        </div>
                        <button class="btn" onclick="simulateServiceCall()">Simular Llamada entre Servicios</button>
                        <div class="log-container" id="communication-log"></div>
                    </div>

                    <div class="code-block">
# Service Communication - service_client.py
import requests
import asyncio
import aiohttp
from django.conf import settings
import json
import logging

class ServiceClient:
    def __init__(self, service_name, base_url=None):
        self.service_name = service_name
        self.base_url = base_url or self.discover_service()
        self.timeout = 30
        self.circuit_breaker = CircuitBreaker()
    
    def discover_service(self):
        """Service Discovery Implementation"""
        try:
            discovery_url = settings.MICROSERVICE_CONFIG['DISCOVERY_URL']
            response = requests.get(f"{discovery_url}/services/{self.service_name}")
            service_info = response.json()
            return service_info['url']
        except Exception as e:
            logging.error(f"Service discovery failed: {e}")
            return None
    
    async def async_call(self, endpoint, method='GET', data=None):
        """Asynchronous service call"""
        if not self.circuit_breaker.can_execute():
            raise Exception("Circuit breaker is open")
        
        try:
            async with aiohttp.ClientSession() as session:
                url = f"{self.base_url}/{endpoint}"
                async with session.request(method, url, json=data, timeout=self.timeout) as response:
                    result = await response.json()
                    self.circuit_breaker.record_success()
                    return result
        except Exception as e:
            self.circuit_breaker.record_failure()
            raise e
    
    def sync_call(self, endpoint, method='GET', data=None):
        """Synchronous service call"""
        if not self.circuit_breaker.can_execute():
            raise Exception("Circuit breaker is open")
        
        try:
            url = f"{self.base_url}/{endpoint}"
            response = requests.request(method, url, json=data, timeout=self.timeout)
            response.raise_for_status()
            self.circuit_breaker.record_success()
            return response.json()
        except Exception as e:
            self.circuit_breaker.record_failure()
            raise e

# Circuit Breaker Implementation
class CircuitBreaker:
    def __init__(self, failure_threshold=5, recovery_timeout=60):
        self.failure_threshold = failure_threshold
        self.recovery_timeout = recovery_timeout
        self.failure_count = 0
        self.last_failure_time = None
        self.state = 'CLOSED'  # CLOSED, OPEN, HALF_OPEN
    
    def can_execute(self):
        if self.state == 'CLOSED':
            return True
        elif self.state == 'OPEN':
            if self.should_attempt_reset():
                self.state = 'HALF_OPEN'
                return True
            return False
        else:  # HALF_OPEN
            return True
    
    def record_success(self):
        self.failure_count = 0
        self.state = 'CLOSED'
    
    def record_failure(self):
        self.failure_count += 1
        self.last_failure_time = time.time()
        if self.failure_count >= self.failure_threshold:
            self.state = 'OPEN'
    
    def should_attempt_reset(self):
        return (time.time() - self.last_failure_time) > self.recovery_timeout
                    </div>
                </div>

                <div class="exercise-container">
                    <div class="exercise-title">3. Containerizaci√≥n con Docker</div>
                    <p>Implementaci√≥n de microservicios usando Docker y Docker Compose.</p>
                    
                    <div class="interactive-demo">
                        <div class="demo-title">üê≥ Gesti√≥n de Contenedores</div>
                        <button class="btn" onclick="simulateDockerBuild()">Build Images</button>
                        <button class="btn" onclick="simulateDockerRun()">Run Containers</button>
                        <button class="btn" onclick="simulateDockerScale()">Scale Services</button>
                        <button class="btn" onclick="clearDockerLogs()">Clear Logs</button>
                        <div class="log-container" id="docker-log"></div>
                    </div>

                    <div class="code-block">
# Dockerfile para microservicio Django
FROM python:3.9-slim

# Configurar variables de entorno
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1
ENV DJANGO_SETTINGS_MODULE=microservice.settings

# Instalar dependencias del sistema
RUN apt-get update && apt-get install -y \
    build-essential \
    libpq-dev \
    && rm -rf /var/lib/apt/lists/*

# Crear directorio de trabajo
WORKDIR /app

# Copiar requirements y instalar dependencias Python
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copiar c√≥digo fuente
COPY . .

# Crear usuario no-root
RUN adduser --disabled-password --gecos '' appuser
RUN chown -R appuser:appuser /app
USER appuser

# Exponer puerto
EXPOSE 8000

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8000/health/ || exit 1

# Comando por defecto
CMD ["gunicorn", "--bind", "0.0.0.0:8000", "--workers", "4", "microservice.wsgi:application"]
                    </div>

                    <div class="code-block">
# docker-compose.yml
version: '3.8'

services:
  user-service:
    build: ./user-service
    ports:
      - "8001:8000"
    environment:
      - DATABASE_URL=postgresql://user:password@user-db:5432/userdb
      - REDIS_URL=redis://redis:6379/0
      - SERVICE_NAME=user-service
    depends_on:
      - user-db
      - redis
    networks:
      - microservices-network
    deploy:
      replicas: 2
      resources:
        limits:
          cpus: '0.50'
          memory: 512M

  product-service:
    build: ./product-service
    ports:
      - "8002:8000"
    environment:
      - DATABASE_URL=postgresql://product:password@product-db:5432/productdb
      - REDIS_URL=redis://redis:6379/1
      - SERVICE_NAME=product-service
    depends_on:
      - product-db
      - redis
    networks:
      - microservices-network

  order-service:
    build: ./order-service
    ports:
      - "8003:8000"
    environment:
      - DATABASE_URL=postgresql://order:password@order-db:5432/orderdb
      - REDIS_URL=redis://redis:6379/2
      - SERVICE_NAME=order-service
      - USER_SERVICE_URL=http://user-service:8000
      - PRODUCT_SERVICE_URL=http://product-service:8000
    depends_on:
      - order-db
      - redis
      - user-service
      - product-service
    networks:
      - microservices-network

  # Databases
  user-db:
    image: postgres:13
    environment:
      - POSTGRES_DB=userdb
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
    volumes:
      - user_db_data:/var/lib/postgresql/data
    networks:
      - microservices-network

  product-db:
    image: postgres:13
    environment:
      - POSTGRES_DB=productdb
      - POSTGRES_USER=product
      - POSTGRES_PASSWORD=password
    volumes:
      - product_db_data:/var/lib/postgresql/data
    networks:
      - microservices-network

  order-db:
    image: postgres:13
    environment:
      - POSTGRES_DB=orderdb
      - POSTGRES_USER=order
      - POSTGRES_PASSWORD=password
    volumes:
      - order_db_data:/var/lib/postgresql/data
    networks:
      - microservices-network

  redis:
    image: redis:6-alpine
    networks:
      - microservices-network

  # API Gateway
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - user-service
      - product-service
      - order-service
    networks:
      - microservices-network

volumes:
  user_db_data:
  product_db_data:
  order_db_data:

networks:
  microservices-network:
    driver: bridge
                    </div>
                </div>
            </div>

            <!-- Reflexi√≥n Final -->
            <div class="section">
                <h2>Reflexi√≥n Final</h2>
                <div class="reflection-text">
                    <p>La implementaci√≥n de <span class="highlight">microservicios con Django</span> ha representado un cambio paradigm√°tico en mi comprensi√≥n del desarrollo de aplicaciones empresariales. Esta semana me ha permitido explorar c√≥mo transformar aplicaciones monol√≠ticas en sistemas distribuidos m√°s escalables y mantenibles.</p>
                    
                    <p>El aprendizaje m√°s significativo ha sido comprender que los microservicios no son solo una cuesti√≥n t√©cnica, sino que requieren un cambio fundamental en la <span class="highlight">arquitectura organizacional y de desarrollo</span>. La independencia que proporcionan los microservicios permite que equipos diferentes trabajen en servicios separados, pero tambi√©n introduce complejidades en la coordinaci√≥n y comunicaci√≥n.</p>
                    
                    <p>La experiencia pr√°ctica con <span class="highlight">Docker y Kubernetes</span> me ha demostrado la importancia de la containerizaci√≥n para garantizar la consistencia entre entornos de desarrollo, pruebas y producci√≥n. La capacidad de escalar servicios individualmente seg√∫n la demanda es una ventaja significativa sobre las arquitecturas monol√≠ticas.</p>
                    
                    <p>Uno de los aspectos m√°s desafiantes ha sido la gesti√≥n de la <span class="highlight">comunicaci√≥n entre servicios</span>. Implementar patrones como circuit breakers, service discovery y manejo de fallos distribuidos requiere un nivel de planificaci√≥n y dise√±o mucho m√°s sofisticado que el desarrollo tradicional.</p>
                    
                    <p>La seguridad en microservicios presenta desaf√≠os √∫nicos. La implementaci√≥n de <span class="highlight">autenticaci√≥n y autorizaci√≥n distribuida</span> mediante JWT tokens y API gateways requiere una comprensi√≥n profunda de los principios de seguridad en sistemas distribuidos.</p>
                    
                    <p>El monitoreo y observabilidad se vuelven cr√≠ticos en una arquitectura de microservicios. La capacidad de rastrear requests a trav√©s de m√∫ltiples servicios y correlacionar logs distribuidos es esencial para el debugging y optimizaci√≥n del rendimiento.</p>
                    
                    <p>Esta experiencia me ha preparado para enfrentar los desaf√≠os del desarrollo de aplicaciones modernas a escala empresarial, donde la <span class="highlight">escalabilidad, mantenibilidad y resiliencia</span> son requisitos fundamentales para el √©xito del producto.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Estado global de los servicios
        let services = {
            'user-service': { active: true, calls: 0 },
            'product-service': { active: true, calls: 0 },
            'order-service': { active: true, calls: 0 },
            'payment-service': { active: true, calls: 0 }
        };

        // Funci√≥n para mostrar detalles de temas
        function showTopicDetails(topic) {
            const topics = {
                'microservicios': {
                    title: 'üèóÔ∏è Arquitectura de Microservicios',
                    content: `
                        <h4>Principios Fundamentales:</h4>
                        <ul>
                            <li><strong>Single Responsibility:</strong> Cada servicio tiene una responsabilidad espec√≠fica</li>
                            <li><strong>Decentralized:</strong> Servicios independientes con sus propias bases de datos</li>
                            <li><strong>Fault Tolerance:</strong> Fallos aislados no afectan todo el sistema</li>
                            <li><strong>Technology Agnostic:</strong> Cada servicio puede usar tecnolog√≠as diferentes</li>
                        </ul>
                        
                        <h4>Ventajas vs Monolitos:</h4>
                        <ul>
                            <li>Escalabilidad independiente por servicio</li>
                            <li>Desarrollo paralelo por equipos</li>
                            <li>Tecnolog√≠as heterog√©neas</li>
                            <li>Deployment independiente</li>
                            <li>Mejor aislamiento de fallos</li>
                        </ul>
                    `
                },
                'django-micro': {
                    title: 'üöÄ Django para Microservicios',
                    content: `
                        <h4>Configuraci√≥n Espec√≠fica:</h4>
                        <ul>
                            <li><strong>Django REST Framework:</strong> Para APIs robustas</li>
                            <li><strong>Database Routing:</strong> Gesti√≥n de m√∫ltiples bases de datos</li>
                            <li><strong>Service Discovery:</strong> Registro autom√°tico de servicios</li>
                            <li><strong>Health Checks:</strong> Monitoreo de salud del servicio</li>
                        </ul>
                        
                        <h4>Optimizaciones:</h4>
                        <ul>
                            <li>Desactivar middlewares innecesarios</li>
                            <li>Configurar CORS para comunicaci√≥n entre servicios</li>
                            <li>Implementar caching distribuido</li>
                            <li>Optimizar queries para reducir latencia</li>
                        </ul>
                    `
                },
                'comunicacion': {
                    title: 'üîÑ Comunicaci√≥n entre Servicios',
                    content: `
                        <h4>Patrones de Comunicaci√≥n:</h4>
                        <ul>
                            <li><strong>Synchronous:</strong> REST APIs, GraphQL</li>
                            <li><strong>Asynchronous:</strong> Message Queues, Event Streaming</li>
                            <li><strong>Request-Response:</strong> HTTP calls directas</li>
                            <li><strong>Publish-Subscribe:</strong> Event-driven architecture</li>
                        </ul>
                        
                        <h4>Herramientas:</h4>
                        <ul>
                            <li>RabbitMQ, Apache Kafka para messaging</li>
                            <li>Redis para caching distribuido</li>
                            <li>Celery para tareas as√≠ncronas</li>
                            <li>API Gateway para enrutamiento</li>
                        </ul>
                    `
                },
                'bases-datos': {
                    title: 'üóÑÔ∏è Gesti√≥n de Bases de Datos',
                    content: `
                        <h4>Database per Service:</h4>
                        <ul>
                            <li>Cada microservicio tiene su propia base de datos</li>
                            <li>Aislamiento completo de datos</li>
                            <li>Tecnolog√≠as de BD espec√≠ficas por servicio</li>
                            <li>Backup y recovery independientes</li>
                        </ul>
                        
                        <h4>Desaf√≠os:</h4>
                        <ul>
                            <li>Transacciones distribuidas (SAGA pattern)</li>
                            <li>Consistencia eventual</li>
                            <li>Sincronizaci√≥n de datos</li>
                            <li>Queries cross-service</li>
                        </ul>
                    `
                },
                'docker-k8s': {
                    title: 'üê≥ Docker & Kubernetes',
                    content: `
                        <h4>Containerizaci√≥n:</h4>
                        <ul>
                            <li>Dockerfile optimizado para Django</li>
                            <li>Multi-stage builds para reducir tama√±o</li>
                            <li>Health checks integrados</li>
                            <li>Manejo de secrets y configuraciones</li>
                        </ul>
                        
                        <h4>Orquestaci√≥n:</h4>
                        <ul>
                            <li>Kubernetes deployments y services</li>
                            <li>Auto-scaling horizontal y vertical</li>
                            <li>Service mesh (Istio, Linkerd)</li>
                            <li>CI/CD pipelines automatizados</li>
                        </ul>
                    `
                },
                'seguridad': {
                    title: 'üîí Seguridad en Microservicios',
                    content: `
                        <h4>Autenticaci√≥n & Autorizaci√≥n:</h4>
                        <ul>
                            <li>JWT tokens para stateless authentication</li>
                            <li>OAuth 2.0 y OpenID Connect</li>
                            <li>API Gateway para centralized auth</li>
                            <li>Role-based access control (RBAC)</li>
                        </ul>
                        
                        <h4>Seguridad de Red:</h4>
                        <ul>
                            <li>TLS/SSL para comunicaci√≥n segura</li>
                            <li>Network policies en Kubernetes</li>
                            <li>Service mesh para mTLS</li>
                            <li>Secrets management (Vault, K8s secrets)</li>
                        </ul>
                    `
                },
                'monitoreo': {
                    title: 'üìä Monitoreo y Escalado',
                    content: `
                        <h4>Observabilidad:</h4>
                        <ul>
                            <li>Logging distribuido (ELK Stack)</li>
                            <li>M√©tricas con Prometheus + Grafana</li>
                            <li>Distributed tracing (Jaeger, Zipkin)</li>
                            <li>Health checks y heartbeats</li>
                        </ul>
                        
                        <h4>Escalado:</h4>
                        <ul>
                            <li>Horizontal Pod Autoscaler (HPA)</li>
                            <li>Vertical Pod Autoscaler (VPA)</li>
                            <li>Custom metrics scaling</li>
                            <li>Load balancing strategies</li>
                        </ul>
                    `
                },
                'consumo': {
                    title: 'üîå Consumo de Microservicios',
                    content: `
                        <h4>Integration Patterns:</h4>
                        <ul>
                            <li>Service discovery (Consul, Eureka)</li>
                            <li>Circuit breaker pattern</li>
                            <li>Retry mechanisms con exponential backoff</li>
                            <li>Timeout y fallback strategies</li>
                        </ul>
                        
                        <h4>Client Libraries:</h4>
                        <ul>
                            <li>HTTP clients con connection pooling</li>
                            <li>Async/await para mejor performance</li>
                            <li>Caching de responses</li>
                            <li>Request/response logging</li>
                        </ul>
                    `
                }
            };

            const topic = topics[topic];
            if (topic) {
                alert(`${topic.title}\n\n${topic.content.replace(/<[^>]*>/g, '').replace(/&nbsp;/g, ' ')}`);
            }
        }

        // Funci√≥n para alternar estado de servicios
        function toggleService(serviceName) {
            services[serviceName].active = !services[serviceName].active;
            const statusElement = document.getElementById(`${serviceName}-status`);
            
            if (services[serviceName].active) {
                statusElement.textContent = '‚óè ACTIVE';
                statusElement.className = 'service-status status-active';
                logMessage(`‚úÖ ${serviceName} is now ACTIVE`, 'success');
            } else {
                statusElement.textContent = '‚óè INACTIVE';
                statusElement.className = 'service-status status-inactive';
                logMessage(`‚ùå ${serviceName} is now INACTIVE`, 'error');
            }
        }

        // Funci√≥n para simular llamadas entre servicios
        function simulateServiceCall() {
            const logContainer = document.getElementById('communication-log');
            const services = ['user-service', 'product-service', 'order-service', 'payment-service'];
            
            logContainer.innerHTML = '';
            
            logMessage('üöÄ Iniciando flujo de comunicaci√≥n entre servicios...', 'info');
            
            setTimeout(() => {
                logMessage('üì° Frontend ‚Üí API Gateway: GET /api/orders', 'info');
            }, 500);
            
            setTimeout(() => {
                logMessage('üîÑ API Gateway ‚Üí Order Service: GET /orders', 'info');
            }, 1000);
            
            setTimeout(() => {
                logMessage('üîÑ Order Service ‚Üí User Service: GET /users/123', 'info');
            }, 1500);
            
            setTimeout(() => {
                logMessage('‚úÖ User Service ‚Üí Order Service: User data retrieved', 'success');
            }, 2000);
            
            setTimeout(() => {
                logMessage('üîÑ Order Service ‚Üí Product Service: GET /products/456', 'info');
            }, 2500);
            
            setTimeout(() => {
                logMessage('‚úÖ Product Service ‚Üí Order Service: Product data retrieved', 'success');
            }, 3000);
            
            setTimeout(() => {
                logMessage('üîÑ Order Service ‚Üí Payment Service: POST /payments', 'info');
            }, 3500);
            
            setTimeout(() => {
                logMessage('‚úÖ Payment Service ‚Üí Order Service: Payment processed', 'success');
            }, 4000);
            
            setTimeout(() => {
                logMessage('‚úÖ Order Service ‚Üí API Gateway: Order created successfully', 'success');
            }, 4500);
            
            setTimeout(() => {
                logMessage('üéâ API Gateway ‚Üí Frontend: 201 Created - Order ID: ORD-2024-001', 'success');
            }, 5000);
        }

        // Funci√≥n para simular construcci√≥n de Docker
        function simulateDockerBuild() {
            const logContainer = document.getElementById('docker-log');
            
            logMessage('üê≥ Starting Docker build process...', 'info');
            
            setTimeout(() => {
                logMessage('üì¶ Building user-service:latest...', 'info');
            }, 500);
            
            setTimeout(() => {
                logMessage('‚úÖ user-service:latest built successfully', 'success');
            }, 1500);
            
            setTimeout(() => {
                logMessage('üì¶ Building product-service:latest...', 'info');
            }, 2000);
            
            setTimeout(() => {
                logMessage('‚úÖ product-service:latest built successfully', 'success');
            }, 3000);
            
            setTimeout(() => {
                logMessage('üì¶ Building order-service:latest...', 'info');
            }, 3500);
            
            setTimeout(() => {
                logMessage('‚úÖ order-service:latest built successfully', 'success');
            }, 4500);
            
            setTimeout(() => {
                logMessage('üéâ All microservices built successfully!', 'success');
            }, 5000);
        }

        // Funci√≥n para simular ejecuci√≥n de contenedores
        function simulateDockerRun() {
            const logContainer = document.getElementById('docker-log');
            
            logMessage('üöÄ Starting containers...', 'info');
            
            setTimeout(() => {
                logMessage('üìä Starting PostgreSQL databases...', 'info');
            }, 500);
            
            setTimeout(() => {
                logMessage('‚úÖ user-db container started on port 5432', 'success');
            }, 1000);
            
            setTimeout(() => {
                logMessage('‚úÖ product-db container started on port 5433', 'success');
            }, 1500);
            
            setTimeout(() => {
                logMessage('‚úÖ order-db container started on port 5434', 'success');
            }, 2000);
            
            setTimeout(() => {
                logMessage('üîÑ Starting Redis cache...', 'info');
            }, 2500);
            
            setTimeout(() => {
                logMessage('‚úÖ Redis container started on port 6379', 'success');
            }, 3000);
            
            setTimeout(() => {
                logMessage('üåê Starting microservices...', 'info');
            }, 3500);
            
            setTimeout(() => {
                logMessage('‚úÖ user-service started on port 8001', 'success');
            }, 4000);
            
            setTimeout(() => {
                logMessage('‚úÖ product-service started on port 8002', 'success');
            }, 4500);
            
            setTimeout(() => {
                logMessage('‚úÖ order-service started on port 8003', 'success');
            }, 5000);
            
            setTimeout(() => {
                logMessage('üéâ All services are running and healthy!', 'success');
            }, 5500);
        }

        // Funci√≥n para simular escalado de servicios
        function simulateDockerScale() {
            const logContainer = document.getElementById('docker-log');
            
            logMessage('‚öñÔ∏è Scaling services based on load...', 'info');
            
            setTimeout(() => {
                logMessage('üìä Analyzing current load metrics...', 'info');
            }, 500);
            
            setTimeout(() => {
                logMessage('üîç user-service: CPU 85%, Memory 70% - Scaling up', 'info');
            }, 1000);
            
            setTimeout(() => {
                logMessage('‚úÖ user-service scaled to 3 replicas', 'success');
            }, 1500);
            
            setTimeout(() => {
                logMessage('üîç product-service: CPU 45%, Memory 30% - No scaling needed', 'info');
            }, 2000);
            
            setTimeout(() => {
                logMessage('üîç order-service: CPU 90%, Memory 85% - Scaling up', 'info');
            }, 2500);
            
            setTimeout(() => {
                logMessage('‚úÖ order-service scaled to 4 replicas', 'success');
            }, 3000);
            
            setTimeout(() => {
                logMessage('üîÑ Updating load balancer configuration...', 'info');
            }, 3500);
            
            setTimeout(() => {
                logMessage('‚úÖ Load balancer updated successfully', 'success');
            }, 4000);
            
            setTimeout(() => {
                logMessage('üéâ Auto-scaling completed successfully!', 'success');
            }, 4500);
        }

        // Funci√≥n para limpiar logs de Docker
        function clearDockerLogs() {
            const logContainer = document.getElementById('docker-log');
            logContainer.innerHTML = '';
            logMessage('üßπ Logs cleared', 'info');
        }

        // Funci√≥n auxiliar para agregar mensajes al log
        function logMessage(message, type = 'info') {
            const logContainer = document.getElementById('communication-log') || document.getElementById('docker-log');
            if (!logContainer) return;
            
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        // Inicializar animaciones y efectos
        document.addEventListener('DOMContentLoaded', function() {
            // Animaci√≥n de entrada para las cards
            const cards = document.querySelectorAll('.topic-card, .service-card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.style.animation = 'slideInUp 0.6s ease-out forwards';
            });
            
            // Agregar estilos CSS para animaciones
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInUp {
                    from {
                        opacity: 0;
                        transform: translateY(30px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                .topic-card, .service-card {
                    opacity: 0;
                }
                
                .service-card:hover {
                    animation: pulse 0.6s ease-in-out;
                }
                
                @keyframes pulse {
                    0% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                    100% { transform: scale(1); }
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
